# 仕入POS UI 整理・目標と現状

**目的**: 仕入タイルの4画面を「出庫コンディション／出庫商品リスト／入庫履歴一覧／入庫商品リスト」のUIを**そのまま**流用し、項目と処理だけ仕入用に差し替える。

**前提**: 複数配送は不要。単一の「仕入1件＝1リスト」でよい。

---

## 1. 目標UIの定義（参照元）

| 仕入画面 | 参照元 | 参照ファイル・コンポーネント | 目標UIの要点 |
|----------|--------|------------------------------|--------------|
| **仕入コンディション** | 出庫コンディション | `stock-transfer-tile` → `ModalOutbound.jsx` 内 **OutboundConditions** (L1490〜) | 出庫元/宛先 → **入庫先のみ**。配送情報（業者・番号・時間指定）はインライン展開「変更」「閉じる」トグル。フッターは **FixedFooterNavBar**：左=画像ON/OFF、中央=履歴一覧、右=次へ。サマリー行は「入庫先: XXX」。 |
| **仕入商品リスト** | 出庫商品リスト | `stock-transfer-tile` → `ModalOutbound.jsx` 内 **OutboundList**（商品リスト画面） | 検索・スキャン・追加済みリスト・数量（−/数値/＋）。フッターは戻る・在庫更新・確定系。複数シップメント・配送リストは不要。 |
| **仕入履歴一覧** | 入庫コンディション（履歴一覧部分） | `stock-transfer-inbound` → `Modal.jsx` 内 **InboundConditions** (L154〜) の**一覧表示部分** | ヘッダー：**未入庫 N件 / 入庫済み N件** タブ。本文：カード一覧（仕入ID・日付・入庫先・仕入先・ステータス・数量）。フッター：**FixedFooterNavBar**（左=画像ON/OFF、右=再読込）。複数配送の「リスト」ボタン・「配送ごと/まとめて」モーダルは不要。 |
| **仕入履歴商品リスト** | 入庫商品リスト | `stock-transfer-inbound` → **InboundListScreen.jsx** | ヘッダー：仕入ID・入庫先・ステータス・検索等。本文：行ごとに商品・数量（確定済みはグレーアウト）。フッター：ステータス・合計・戻る等。複数シップメントの「まとめて表示」は不要。 |

---

## 2. 現状との差分（反映すべき点）

### 2.1 仕入コンディション

| 項目 | 目標（出庫コンディション準拠） | 現状（仕入） | 対応 |
|------|-------------------------------|--------------|------|
| **レイアウト** | 1本のスクロール内に「出庫元/宛先」→「配送情報」の順。出庫元・宛先は行＋「変更」でインライン展開。 | 4ブロック（入庫先・基本情報・仕入先・配送情報）を `surface-secondary` のカードで縦並び。`s-select` でロケーション選択。 | 出庫と同型に変更：入庫先1行＋「変更」でインライン展開。配送情報は「配送情報」見出し＋バッジ「任意」＋インライン「時間指定」等。 |
| **フッター** | **FixedFooterNavBar**。1行目：summaryLeft / summaryRight（例：入庫先: 店舗名）。2行目：左=画像ON/OFF、中央=履歴一覧、右=次へ。 | 独自の `s-footer`＋3ボタン（閉じる・履歴一覧・次へ）。サマリー行なし。画像ON/OFFなし。 | FixedFooterNavBar を利用。summaryLeft=「入庫先: XXX」、中央=履歴一覧、右=次へ。画像ON/OFFを左に配置（liteMode 連動）。 |
| **ヘッダー** | 子で setHeader(null) して固定ヘッダーを消す。s-page の heading はモーダル側で「仕入」。 | setHeader に `<s-header><s-page heading="仕入コンディション" /></s-header>` を設定。 | 出庫同様、setHeader(null) にし、見出しはモーダルまたは s-page の heading に一本化。 |
| **配送情報** | 配送業者・配送番号・到着予定（時間指定は「時間を選択」→「閉じる」トグル、午前中/12:00等のボタン）。 | 検索＋s-select＋「その他」＋配送番号・到着予定日（date）。 | 出庫の配送情報ブロックと同じ構成（業者・番号・到着日時＋時間帯ボタン）に合わせる。 |
| **入庫先** | 「入庫先: 名前」＋「変更」ボタン。押下でインラインに検索＋ロケーションリスト。 | s-select でドロップダウン。 | 「入庫先: XXX」＋「変更」でインライン展開に変更。 |

---

### 2.2 仕入商品リスト

| 項目 | 目標（出庫商品リスト準拠） | 現状（仕入） | 対応 |
|------|-----------------------------|--------------|------|
| **画面** | 出庫の OutboundList と同UI（検索・スキャン・追加済み・数量）。 | **未実装**（「この画面は現在準備中です」のみ）。 | 出庫商品リストをコピーし、項目と処理を仕入用に差し替え（在庫はプラス調整）。複数配送・配送リストは作らない。 |

---

### 2.3 仕入履歴一覧

| 項目 | 目標（入庫コンディションの履歴一覧部分と同UI） | 現状（仕入） | 対応 |
|------|------------------------------------------------|--------------|------|
| **ヘッダー** | 未入庫 N件 / 入庫済み N件 のタブ。必要なら「読込」で追加読み込み。 | **未実装**（準備中画面）。 | 入庫の InboundConditions の一覧部分をコピー。タブ＋カード一覧。データは purchase_entries_v1。 |
| **本文** | カード：仕入ID（名称）・日付・入庫先・仕入先・ステータスバッジ・数量。タップで詳細（商品リスト）へ。 | なし。 | 上記に合わせて実装。複数配送用「リスト」ボタン・モーダルは不要。 |
| **フッター** | FixedFooterNavBar。左=画像ON/OFF、右=再読込。サマリー左=入庫先、右=未入庫/入庫済み N件。 | なし。 | 同様に実装。 |

---

### 2.4 仕入履歴商品リスト

| 項目 | 目標（入庫商品リスト＝InboundListScreen と同UI） | 現状（仕入） | 対応 |
|------|--------------------------------------------------|--------------|------|
| **画面** | ヘッダー（仕入ID・入庫先・ステータス・検索・画像等）＋明細テーブル＋フッター（ステータス・合計・戻る等）。 | **未実装**。 | InboundListScreen をベースにコピー。表示データは仕入1件の items。確定済みは数量グレーアウト。複数シップメント表示は不要。 |

---

## 3. 反映タスク一覧（一つずつ進められる単位）

以下の順で進めると、目標UIに近づけられます。

1. **仕入コンディションのフッターを FixedFooterNavBar に統一**
   - 仕入拡張に `FixedFooterNavBar.jsx` をコピー（または共通化）。
   - PurchaseConditions の setFooter を FixedFooterNavBar に変更（summaryLeft=入庫先、中央=履歴一覧、右=次へ、左=画像ON/OFF）。

2. **仕入コンディションのレイアウトを出庫コンディション型に変更**
   - 入庫先を「入庫先: 名前」＋「変更」のインライン展開に変更（s-select 廃止）。
   - 配送情報を出庫と同じブロック構成に（業者・番号・到着日時・時間指定トグル）。

3. **仕入コンディションのヘッダー**
   - setHeader(null) にし、見出しはモーダル側の s-page に一本化。

4. **仕入商品リストの実装**
   - 出庫の OutboundList（商品リスト部分）をコピーし、仕入用に変更（在庫プラス・複数配送なし）。

5. **仕入履歴一覧の実装**
   - 入庫の InboundConditions の履歴一覧部分（タブ＋カード一覧＋フッター）をコピーし、データを purchase_entries_v1 に差し替え。複数配送用UIは削除。

6. **仕入履歴商品リストの実装**
   - InboundListScreen をコピーし、仕入1件の商品リスト表示に変更。複数シップメント表示は削除。

---

## 4. 参照コードの場所（コピー元）

| 目標 | 参照ファイル（パス） | 主なコンポーネント/行目目安 |
|------|----------------------|-----------------------------|
| 出庫コンディション | `extensions/stock-transfer-tile/src/ModalOutbound.jsx` | OutboundConditions (L1490〜)、FixedFooterNavBar 使用 (L2202〜2235)、配送情報 (L2365〜)、入庫先は「宛先」のインライン展開 (L2304〜2362) |
| 出庫商品リスト | `extensions/stock-transfer-tile/src/ModalOutbound.jsx` | OutboundList（商品リスト画面）を検索で特定 |
| 入庫履歴一覧 | `extensions/stock-transfer-inbound/src/Modal.jsx` | InboundConditions (L154〜)、viewMode タブ・listToShow カード (L373〜538)、FixedFooterNavBar (L401〜415) |
| 入庫商品リスト | `extensions/stock-transfer-inbound/src/screens/InboundListScreen.jsx` | InboundListScreen (L172〜)、ヘッダー・フッター・行表示 |
| FixedFooterNavBar | `extensions/stock-transfer-inbound/src/FixedFooterNavBar.jsx` または `ModalOutbound.jsx` 内定義 (L696〜) | 共通コンポーネントとして仕入拡張に配置 |

---

**次のステップ**: 上記タスク 1 から順に、「仕入コンディションのフッターを FixedFooterNavBar に統一」から反映していく。
