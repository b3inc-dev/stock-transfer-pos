# 設定画面のグルーピング計画

## 📋 現在の設定項目

### 既存の設定項目
1. **店舗グループ**（destinationGroups）
2. **配送会社**（carriers）

### 追加予定の設定項目
3. **表示ロケーション選択設定**
4. **出庫：強制キャンセル処理許可設定**
5. **入庫：過剰入庫許可設定**
6. **入庫：予定外入庫許可設定**

---

## 🎯 グルーピング案

### 案1: 機能別グルーピング（推奨）

```
設定画面
├─ 基本設定
│  └─ 表示ロケーション選択設定
│
├─ 店舗グループ設定
│  └─ 店舗グループ（宛先ロケーションの絞り込み）
│
├─ 配送設定
│  └─ 配送会社（選択式：POS側で表記ゆれ防止）
│
├─ 出庫設定
│  └─ 強制キャンセル処理許可設定
│
└─ 入庫設定
   ├─ 過剰入庫許可設定
   └─ 予定外入庫許可設定
```

**メリット**:
- 機能ごとに整理されてわかりやすい
- 関連する設定がまとまっている
- 将来的に設定項目が増えても拡張しやすい

---

### 案2: 使用頻度別グルーピング

```
設定画面
├─ よく使う設定
│  ├─ 店舗グループ設定
│  ├─ 配送会社設定
│  └─ 表示ロケーション選択設定
│
└─ 詳細設定
   ├─ 出庫設定
   │  └─ 強制キャンセル処理許可設定
   └─ 入庫設定
      ├─ 過剰入庫許可設定
      └─ 予定外入庫許可設定
```

**メリット**:
- よく使う設定にすぐアクセスできる
- 詳細設定は折りたたみ可能

---

## ✅ 推奨案: 案1（機能別グルーピング）

### 実装方法

#### UIコンポーネント
Shopify Polaris Web Componentsを使用：
- `<s-section>`: 各グループをセクションで区切る
- `<s-collapsible>`: オプションで折りたたみ可能にする（必要に応じて）

#### 画面レイアウト

```tsx
<s-page heading="設定">
  <s-scroll-box padding="base">
    <s-stack gap="base">
      {/* 基本設定 */}
      <s-section heading="基本設定">
        {/* 表示ロケーション選択設定 */}
      </s-section>

      <s-divider />

      {/* 店舗グループ設定 */}
      <s-section heading="店舗グループ設定">
        {/* 既存の店舗グループ設定 */}
      </s-section>

      <s-divider />

      {/* 配送設定 */}
      <s-section heading="配送設定">
        {/* 既存の配送会社設定 */}
      </s-section>

      <s-divider />

      {/* 出庫設定 */}
      <s-section heading="出庫設定">
        {/* 強制キャンセル処理許可設定 */}
      </s-section>

      <s-divider />

      {/* 入庫設定 */}
      <s-section heading="入庫設定">
        {/* 過剰入庫許可設定 */}
        {/* 予定外入庫許可設定 */}
      </s-section>

      <s-divider />

      {/* 保存ボタン */}
      <s-stack direction="inline" gap="base">
        <s-button tone="critical" onClick={reset}>破棄して戻す</s-button>
        <s-button tone="success" onClick={save}>保存</s-button>
      </s-stack>
    </s-stack>
  </s-scroll-box>
</s-page>
```

---

## 🔍 実装可能性の確認

### ✅ 実装可能

#### 1. Shopify Polaris Web Components
- **管理画面側**: Polaris Web Components（`<s-section>`, `<s-divider>`等）が使用可能
- **実装済み**: 既存の設定画面でも使用されている
- **制約**: なし（管理画面側なのでPOS UI Extensionの制約は適用されない）

#### 2. データ保存
- **方法**: Metafield（既に実装済み）
- **制約**: なし
- **拡張性**: `SettingsV1` 型を拡張するだけ

#### 3. UIコンポーネント
- **チェックボックス**: `<s-checkbox>` または `<s-button>` で実装可能
- **トグルスイッチ**: `<s-checkbox>` で実装可能
- **数値入力**: `<s-text-field>` で実装可能

---

## 📝 実装手順

### Step 1: SettingsV1型の拡張
- 新しい設定項目を型定義に追加

### Step 2: UIコンポーネントの追加
- 各セクションに設定項目を追加
- グルーピングして整理

### Step 3: 状態管理の実装
- 各設定項目の状態管理
- 保存処理の実装

### Step 4: 動作確認
- 各設定項目の保存・読み込み確認

---

## 🎨 UIデザインの考慮事項

### セクションの見出し
- 各セクションに明確な見出しを付ける
- 説明文を追加（必要に応じて）

### 視覚的な区切り
- `<s-divider>` でセクションを区切る
- 適切な間隔を保つ

### 保存ボタン
- 画面下部に固定
- 破棄ボタンと並べて配置

---

## 📚 参考

- Shopify Polaris Web Components: https://polaris.shopify.com/
- 既存の実装: `/app/routes/app.settings.tsx`
